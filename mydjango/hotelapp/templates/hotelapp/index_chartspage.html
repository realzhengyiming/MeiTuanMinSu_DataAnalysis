{% extends 'hotelapp/index_charts.html' %}
{#å¤šappçš„æ–¹æ¡ˆä¸­templateéœ€è¦è¿™æ ·æ¥å¼•å…¥ï¼Œviewä¸­ä¹Ÿæ˜¯éœ€è¦åŠ ä¸Š#}
{#è¿™ä¸ªæ˜¯é»˜è®¤çš„ä¸»é¡µçš„é¡µé¢#}
{% block title %}
{{ app_name }}
{% endblock %}

{% block drawer_body %}mdui-drawer-body-left{% endblock %}

{% block drawer_icon %}
    <span class=" mdui-btn mdui-btn-icon mdui-ripple mdui-ripple-white" mdui-drawer="{target: '#main-drawer', swipe: true}">
        <i class="mdui-icon material-icons">menu</i></span>
{% endblock %}

{% block drawer %}
<div class="mdui-drawer " id="main-drawer">
  <div class="mdui-list" mdui-collapse="{accordion: true}" style="margin-bottom: 76px;">
    <div class="mdui-collapse-item mdui-collapse-item-open">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue">near_me</i>
        <div class="mdui-list-item-content">å¼€å§‹ä½¿ç”¨</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-collapse-item-open ">
      <a href="{%url 'hotelapp:index' %}" class="mdui-list-item mdui-ripple mdui-list-item-active">æ•°æ®æ¦‚ç•¥</a>
        <a href="{% url 'hotelapp:detaillist' %}" class="mdui-list-item mdui-ripple ">è¯¦ç»†æ•°æ®</a>
         </div>
  </div>

         <div class="mdui-collapse-item ">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <!--<i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue">near_me</i>-->
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue">insert_chart</i>
        <div class="mdui-list-item-content">åˆ†æ</div>
          <!--<i class="mdui-collapse-item-arrow mdui-icon material-icons">insert_chart</i>-->
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-collapse-item-open ">
           <a href="{% url 'hotelapp:host' %}" class="mdui-list-item mdui-ripple ">æˆ¿ä¸œæ•°æ®åˆ†æ</a>
          <!--<a href="{% url 'hotelapp:consumer' %}" class="mdui-list-item mdui-ripple ">æˆ¿å®¢ä¸“åŒº</a>-->
          <a ><div class="mdui-divider"></div></a>
      <!--<a  class="mdui-list-item mdui-ripple ">house_title</a>-->
        <a href="{% url 'hotelapp:price' %}" class="mdui-list-item mdui-ripple ">æˆ¿æºä»·æ ¼åˆ†æ</a>
       <!--<a href="{% url 'hotelapp:detaillist' %}" class="mdui-list-item mdui-ripple ">åœ°ç†ä½ç½®åˆ†æ</a>-->
        <a href="{% url 'hotelapp:time' %}" class="mdui-list-item mdui-ripple ">å‘å¸ƒæ—¶é—´åˆ†æ</a>
      <!--<a href="{% url 'hotelapp:favcount' %}" class="mdui-list-item mdui-ripple ">å–œæ¬¢æ•°åˆ†æ</a>-->
        <a href="{% url 'hotelapp:area' %}" class="mdui-list-item mdui-ripple ">æˆ¿æºé¢ç§¯åˆ†æ</a>
      <!--<a href="{% url 'hotelapp:favcount' %}" class="mdui-list-item mdui-ripple ">å–œæ¬¢æ•°åˆ†æ</a>-->
        <!--<a href="{% url 'hotelapp:facilityPage' %}" class="mdui-list-item mdui-ripple ">æˆ¿æº</a>-->
        <a href="{% url 'hotelapp:facilityPage' %}" class="mdui-list-item mdui-ripple ">æˆ¿æºè®¾æ–½åˆ†æ</a>
             <a ><div class="mdui-divider"></div></a>
        <a href="{% url 'hotelapp:assess' %}" class="mdui-list-item mdui-ripple ">æˆ¿æºä»·æ ¼è¯„ä¼°</a>

                <!--<a href="{% url 'hotelapp:favcount' %}" class="mdui-list-item mdui-ripple ">æˆ¿ä»·è¯„ä¼°</a>-->

       <a ><div class="mdui-divider"></div></a>

    </div>
  </div>

  </div>
</div>
<a id="anchor-top"></a>
{% endblock %}



{% block app_name %}
{{ app_name }}
{% endblock %}

{% block name %}
{{ app_name }}
{% endblock %}

{% block content %}
<div class="mdui-container ">
{#    è¿™å„¿æ‰æ˜¯å†…å®¹çš„åŒºåŸŸå‘¢#}
  <h1 class="doc-title ">æ•°æ®æ¦‚è§ˆ</h1>
  <div class="doc-intro mdui-typo">

<div class="mdui-container">


    <div class="mdui-valign mdui-center">
       <div class="mdui-chip ">
             <span class="mdui-chip-icon">ğŸ†</span>
            <span id="count_today" class="mdui-chip-title">ä»Šå¤©çš„æˆ¿æºæ•°æ®:{{ count_today.count }}</span>
        </div>
       <div class="mdui-chip ">
             <span class="mdui-chip-icon">ğŸ </span>
            <span class="mdui-chip-title">ä»Šæ—¥çš„åŸå¸‚æ•°é‡:{{ count_today_city.count }}</span>
        </div>
          <div class="mdui-chip ">
             <span class="mdui-chip-icon">ğŸ™</span>
            <span class="mdui-chip-title">æ€»å…±çš„åŸå¸‚æ•°é‡:{{ count_total_city.count }}</span>
        </div>

    </div>

<div id="bar-hide">
    <div class="mdui-center mdui-spinner mdui-spinner-colorful" style="margin-top: 220px;"></div>
</div>
    <div class="mdui-center" id="bar" style="width:800px; height:400px;margin-top:60px;display: none;"></div>


    <br>
    <div id="pieview-hide">
    <div class="mdui-center mdui-spinner mdui-spinner-colorful" style="margin-top: 200px;"></div>
    </div>
    <div class="mdui-center" id="pieview" style="display:none;width:800px; height:400px;margin-top: 50px;"></div>


    <br>
    <br>
    <div id="timeline-hide">
    <div class="mdui-center mdui-spinner mdui-spinner-colorful" style="margin-top: 200px;"></div>
</div>
    <div class="mdui-center" id="timeline" style="display:none;width:800px; height:400px; margin-top: 50px;"></div>


{#è¿™ä¸ªæ˜¯åœ°å›¾#}
        <br>
 <div id="drawmap-hide">
    <div class="mdui-center mdui-spinner mdui-spinner-colorful" style="margin-top: 200px;"></div>
</div>
    <div class="mdui-center" id="drawmap" style="display:none;width:800px; height:400px;margin-bottom: 50px;margin-top: 50px;"></div>


    </tbody>
  </table>
</div>


{% endblock %}


{% block tail %}
      <script>
        var chart = echarts.init(document.getElementById('bar'), 'black', {renderer: 'canvas'});

        $(
            function () {
                fetchbarData(chart);
                //setInterval(fetchbarData, 10000);

            }
        );

        function fetchbarData() {
            $.ajax({
                type: "GET",
                url: "{% url 'hotelapp:bar' %}",
                dataType: 'json',
                async: true,
                timeout:5000,

                success: function (result) {
                    chart.setOption(result.data);
                    $('#bar-hide').css('display','none');  // ç»„ä»¶å®Œå…¨éšè—ï¼Œä¸å ç”¨æ˜¾ç¤ºæ—¶å ç”¨çš„ä½ç½®
                    $('#bar').css('display','block');   //åœ¨è®¾ç½®ç»„ä»¶å¯ä»¥çœ‹
                },
                  error : function(XMLHttpRequest,status) { //è¯·æ±‚å®Œæˆåæœ€ç»ˆæ‰§è¡Œå‚æ•°
                    if (status === 'timeout') {//è¶…æ—¶,statusè¿˜æœ‰success,errorç­‰å€¼çš„æƒ…å†µ
                        // temp2.abort();
                        $.ajax(this).abort();

                        // ã€€ã€€ã€€ã€€ã€€  alert("è¶…æ—¶");
                        console.log("è¶…æ—¶,å·²é‡è¯•");
                        // temp2();
                        $.ajax(this);

                        return
                    }
                }
            });
        }
    </script>
    <script>
        var pie_chart = echarts.init(document.getElementById('pieview'), 'black', {renderer: 'canvas'});
        $(
            function () {
                fetchData(pie_chart);
                //setInterval(fetchData, 100000);
            }
        );

        function fetchData() {
            $.ajax({
                type: "GET",
                url: "{% url 'hotelapp:pie' %}",
                dataType: 'json',
                async: true,
                timeout:5000,
                success: function (result) {
                    pie_chart.setOption(result.data);
                    $('#pieview-hide').css('display','none');  // ç»„ä»¶å®Œå…¨éšè—ï¼Œä¸å ç”¨æ˜¾ç¤ºæ—¶å ç”¨çš„ä½ç½®
                    $('#pieview').css('display','block');   //åœ¨è®¾ç½®ç»„ä»¶å¯ä»¥çœ‹
                },
                  error : function(XMLHttpRequest,status) { //è¯·æ±‚å®Œæˆåæœ€ç»ˆæ‰§è¡Œå‚æ•°
                    if (status === 'timeout') {//è¶…æ—¶,statusè¿˜æœ‰success,errorç­‰å€¼çš„æƒ…å†µ
                        // temp2.abort();
                        $.ajax(this).abort();

                        // ã€€ã€€ã€€ã€€ã€€  alert("è¶…æ—¶");
                        console.log("è¶…æ—¶,å·²é‡è¯•");
                        // temp2();
                        $.ajax(this);

                        return
                    }
                }
            });
        }
    </script>
    <script>
        var timeline_chart = echarts.init(document.getElementById('timeline'), 'white', {renderer: 'canvas'});
        $(
            function () {
                fetchData_timeline(timeline_chart);
                //{#setInterval(fetchData_timeline, 10000);#}
            }
        );

        function fetchData_timeline() {
            $.ajax({
                type: "GET",
                url: "{% url 'hotelapp:timeline' %} ",
                dataType: 'json',
                async: true,
                timeout:5000,
                success: function (result) {
                    timeline_chart.setOption(result.data);
                    $('#timeline-hide').css('display','none');  // ç»„ä»¶å®Œå…¨éšè—ï¼Œä¸å ç”¨æ˜¾ç¤ºæ—¶å ç”¨çš„ä½ç½®
                    $('#timeline').css('display','block');   //åœ¨è®¾ç½®ç»„ä»¶å¯ä»¥çœ‹
                },

              error : function(XMLHttpRequest,status) { //è¯·æ±‚å®Œæˆåæœ€ç»ˆæ‰§è¡Œå‚æ•°
                    if (status === 'timeout') {//è¶…æ—¶,statusè¿˜æœ‰success,errorç­‰å€¼çš„æƒ…å†µ
                        // temp2.abort();
                        $.ajax(this).abort();

                        // ã€€ã€€ã€€ã€€ã€€  alert("è¶…æ—¶");
                        console.log("è¶…æ—¶,å·²é‡è¯•");
                        // temp2();
                        $.ajax(this);

                        return
                    }
                }
            });
        }
    </script>
    <script>
        var drawmap_chart = echarts.init(document.getElementById('drawmap'), 'white', {renderer: 'canvas'});
        $(
            function () {
                fetchData_drawmap(drawmap_chart);
                //{#setInterval(fetchData_drawmap, 10000);#}
            }
        );

        function fetchData_drawmap() {
            $.ajax({
                type: "GET",
                url: "{% url 'hotelapp:drawMap' %}",
                dataType: 'json',
                async: true,
                timeout:5000,
                success: function (result) {
                    drawmap_chart.setOption(result.data);
                     $('#drawmap-hide').css('display','none');  // ç»„ä»¶å®Œå…¨éšè—ï¼Œä¸å ç”¨æ˜¾ç¤ºæ—¶å ç”¨çš„ä½ç½®
                    $('#drawmap').css('display','block');   //åœ¨è®¾ç½®ç»„ä»¶å¯ä»¥çœ‹
                },

              error : function(XMLHttpRequest,status) { //è¯·æ±‚å®Œæˆåæœ€ç»ˆæ‰§è¡Œå‚æ•°
                    if (status === 'timeout') {//è¶…æ—¶,statusè¿˜æœ‰success,errorç­‰å€¼çš„æƒ…å†µ
                        // temp2.abort();
                        $.ajax(this).abort();

                        // ã€€ã€€ã€€ã€€ã€€  alert("è¶…æ—¶");
                        console.log("è¶…æ—¶,å·²é‡è¯•");
                        // temp2();
                        $.ajax(this);

                        return
                    }
                }

            });
        }
    </script>

{% endblock %}
  </div>

</div>

